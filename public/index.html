<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tfoi ì›¹ ì œì–´</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            text-align: center; 
            background-color: #162447; /* ì„¸ë ¨ëœ ë„¤ì´ë¹„ */
            color: white;
        }
        .container { 
            display: flex; 
            justify-content: space-around; 
            margin-top: 20px; 
        }
        .box { 
            width: 45%; 
            padding: 20px; 
            background: #f4a261; /* ë¶€ë“œëŸ¬ìš´ ì£¼í™©ìƒ‰ */
            color: white; 
            border-radius: 10px; 
            box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.3);
        }
        .btn { 
            margin: 10px; 
            padding: 10px 20px; 
            font-size: 16px; 
            cursor: pointer; 
            border: none;
        }
        .route-container { 
            background: #888888; 
            padding: 15px; 
            margin-top: 10px; 
            border-radius: 5px; 
        }
        .coordinates { 
            display: flex; 
            flex-wrap: wrap; 
            justify-content: center; 
            margin-top: 10px; 
        }
        .coord-btn { 
            background: white; 
            padding: 5px 10px; 
            margin: 5px; 
            border-radius: 5px; 
            border: none; 
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h1>Tfoi ì›¹ ì œì–´</h1>
    <button class="btn" onclick="toggleMode()">SLAM / Navigation ì „í™˜</button>
    
    <div class="container">
        <!-- ğŸ“Œ SLAM Mapping UI -->
        <div class="box" id="slamBox">
            <h2>SLAM Mapping</h2>
            <p id="slamStatus">SLAM-Mapping ì¤‘ì´ ì•„ë‹˜</p>
            <button class="btn" onclick="startSLAM()">SLAM ì‹œì‘</button>
            <button class="btn" onclick="stopSLAM()">SLAM ì¢…ë£Œ</button>
        </div>

        <!-- ğŸ“Œ Navigation UI -->
        <div class="box" id="navBox">
            <h2>Navigation ììœ¨ì£¼í–‰</h2>
            <p id="navStatus">ëŒ€ê¸° ì¤‘...</p>
            <button class="btn" onclick="saveCurrentPath()">í˜„ì¬ ê²½ë¡œ ì €ì¥</button>
            <button class="btn" onclick="loadRoutes()">ê²½ë¡œ ë¶ˆëŸ¬ì˜¤ê¸°</button>
            
            <!-- ğŸ“Œ ë™ì ìœ¼ë¡œ ê²½ë¡œ ëª©ë¡ì„ í‘œì‹œí•  ê³µê°„ -->
            <div id="route-list"></div>
        </div>
    </div>

    <script>
        let isSLAMMode = true;
        function toggleMode() {
            isSLAMMode = !isSLAMMode;
            document.getElementById("slamBox").style.display = isSLAMMode ? "block" : "none";
            document.getElementById("navBox").style.display = isSLAMMode ? "none" : "block";
        }

        function startSLAM() { document.getElementById("slamStatus").textContent = "SLAM-Mapping ì¤‘..."; }
        function stopSLAM() { document.getElementById("slamStatus").textContent = "SLAM-Mapping ì¤‘ì´ ì•„ë‹˜"; }
        function saveCurrentPath() { alert("í˜„ì¬ ì¢Œí‘œë¥¼ ì €ì¥í•©ë‹ˆë‹¤."); }

        // ğŸ“Œ ì„œë²„ì—ì„œ ê²½ë¡œ ë¶ˆëŸ¬ì˜¤ê¸°
        function loadRoutes() {
            fetch("http://localhost:3000/routes")
                .then(response => response.json())
                .then(data => {
                    console.log("ğŸ“ ë¶ˆëŸ¬ì˜¨ ê²½ë¡œ ë¦¬ìŠ¤íŠ¸:", data.routes);
                    
                    if (data.routes.length === 0) {
                        alert("ì €ì¥ëœ ê²½ë¡œê°€ ì—†ìŠµë‹ˆë‹¤.");
                        return;
                    }

                    displayRoutes(data.routes);
                })
                .catch(error => console.error("âŒ ê²½ë¡œ ë¶ˆëŸ¬ì˜¤ê¸° ì˜¤ë¥˜:", error));
        }

        // ğŸ“Œ ì €ì¥ëœ ëª¨ë“  ê²½ë¡œ ëª©ë¡ í‘œì‹œ
        function displayRoutes(routes) {
            const routeList = document.getElementById("route-list");
            routeList.innerHTML = ""; // ê¸°ì¡´ ë¦¬ìŠ¤íŠ¸ ì´ˆê¸°í™”

            routes.forEach(routeName => {
                const routeButton = document.createElement("button");
                routeButton.textContent = `ğŸ“Œ ${routeName}`;
                routeButton.classList.add("coord-btn");
                routeButton.style.background = "#ffffff";
                routeButton.style.color = "#333";
                routeButton.addEventListener("click", () => displayRoute(routeName));

                routeList.appendChild(routeButton);
            });
        }

        // ğŸ“Œ íŠ¹ì • ê²½ë¡œì˜ ì¢Œí‘œ ë¶ˆëŸ¬ì˜¤ê¸° ë° í‘œì‹œ
        function displayRoute(routeName) {
            fetch(`http://localhost:3000/route/${routeName}`)
                .then(response => response.json())
                .then(data => {
                    console.log(`ğŸ“ ${routeName}ì˜ ì¢Œí‘œ:`, data.coordinates);

                    const routeList = document.getElementById("route-list");
                    routeList.innerHTML = ""; // ê¸°ì¡´ ë¦¬ìŠ¤íŠ¸ ì´ˆê¸°í™”

                    const routeContainer = document.createElement("div");
                    routeContainer.classList.add("route-container");

                    // ê²½ë¡œ ì œëª© ì¶”ê°€
                    const routeTitle = document.createElement("h3");
                    routeTitle.textContent = `ğŸ“Œ ${routeName}`;
                    routeContainer.appendChild(routeTitle);

                    const coordContainer = document.createElement("div");
                    coordContainer.classList.add("coordinates");

                    data.coordinates.forEach(coord => {
                        const coordButton = document.createElement("button");
                        coordButton.textContent = coord;
                        coordButton.classList.add("coord-btn");
                        coordButton.addEventListener("click", () => navigateTo(coord));

                        coordContainer.appendChild(coordButton);
                    });

                    routeContainer.appendChild(coordContainer);
                    routeList.appendChild(routeContainer);
                })
                .catch(error => console.error(`âŒ ${routeName} ì¢Œí‘œ ë¶ˆëŸ¬ì˜¤ê¸° ì˜¤ë¥˜:`, error));
        }

        // ğŸ“Œ íŠ¹ì • ì¢Œí‘œë¡œ ììœ¨ì£¼í–‰ ì‹¤í–‰ (í–¥í›„ ì‹¤ì œ ì´ë™ ê¸°ëŠ¥ ì¶”ê°€ ê°€ëŠ¥)
        function navigateTo(coordinate) {
            alert(`ğŸš— ${coordinate}ë¡œ ì´ë™í•©ë‹ˆë‹¤.`);
            // ì´í›„ ë¡œë´‡ì—ê²Œ í•´ë‹¹ ì¢Œí‘œë¡œ ì´ë™í•˜ë„ë¡ ëª…ë ¹í•˜ëŠ” ì½”ë“œ ì¶”ê°€ ê°€ëŠ¥
        }
    </script>
</body>
</html>
